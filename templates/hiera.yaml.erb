# managed by puppet
---
<%= { 'backends' => @requested_backends }.to_yaml.gsub(/---\s+/, '') %>

:logger: <%= @logger %>

:hierarchy:
<%= @hierarchy.map{|x| x  =~ /%/ ? "  - \"#{x}\"" : "  - #{x}"}.join("\n") %>
<% @requested_backends.each do | backend_name | -%>
<%# dump all the backend data to yaml format %>
<%= { backend_name => @backend_data[backend_name] }.to_yaml.gsub(/---\s+/, '') -%>
<%- end -%>

<% if @merge_behavior -%>
:merge_behavior: <%= @merge_behavior %>
<% end -%>
<% if @merge_behavior == 'deep' && !@deep_merge_options.empty? -%>
:deep_merge_options:
  <%- @deep_merge_options.each do |option_key, option_value| -%>
  :<%= option_key %>: <%= option_value %>
  <%- end -%>
<%- end -%>
<% if @extra_config && !@extra_config.empty? -%>

<%= @extra_config %>
<% end -%>
